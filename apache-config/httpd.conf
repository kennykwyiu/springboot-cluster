# Apache HTTP Server Configuration for Spring Boot Cluster
# This is the main configuration file for the Apache HTTP Server.
# It defines global server settings, loads modules, and includes other configuration files.

ServerRoot "/etc/apache2" # Specifies the top-level directory of the Apache installation.
PidFile ${APACHE_PID_FILE} # Specifies the file where the server records the process ID of the daemon.

# Timeout and KeepAlive settings
Timeout 300 # The number of seconds Apache will wait for I/O in various circumstances.
KeepAlive On # Enables persistent connections, allowing multiple requests over a single TCP connection.
MaxKeepAliveRequests 100 # The maximum number of requests to be served per persistent connection.
KeepAliveTimeout 5 # The number of seconds Apache will wait for a subsequent request on a persistent connection.

# User and Group
# The user and group under which the Apache httpd daemon will answer requests.
User ${APACHE_RUN_USER}
Group ${APACHE_RUN_GROUP}

# Server Information
ServerTokens Prod # Configures the Server response header to only show 


ServerTokens Prod # Configures the Server response header to only show 'Apache'.
ServerSignature Off # Suppresses the server version and virtual host name from error pages.

# Listen on port 80
Listen 80 # Apache will listen for incoming connections on port 80.

# Load required modules
# These modules provide various functionalities like handling HTTP requests, proxying, and security.
LoadModule mpm_prefork_module modules/mod_mpm_prefork.so # Multi-Processing Module for handling requests.
LoadModule authz_core_module modules/mod_authz_core.so # Core authorization directives.
LoadModule dir_module modules/mod_dir.so # Provides the DirectoryIndex directive.
LoadModule mime_module modules/mod_mime.so # Provides the AddType directive for MIME types.
LoadModule rewrite_module modules/mod_rewrite.so # Powerful URL manipulation engine.
LoadModule ssl_module modules/mod_ssl.so # Enables SSL/TLS encryption.
LoadModule headers_module modules/mod_headers.so # Allows modification of HTTP request and response headers.
LoadModule proxy_module modules/mod_proxy.so # Main proxy module.
LoadModule proxy_http_module modules/mod_proxy_http.so # Proxy module for HTTP and HTTPS protocols.
LoadModule proxy_balancer_module modules/mod_proxy_balancer.so # Provides load balancing capabilities.
LoadModule lbmethod_byrequests_module modules/mod_lbmethod_byrequests.so # Load balancing method based on number of requests.
LoadModule status_module modules/mod_status.so # Provides server status information.
LoadModule info_module modules/mod_info.so # Provides server configuration information.

# Directory permissions
# Defines access control for directories.
<Directory />
    AllowOverride none # Disables .htaccess files for security.
    Require all denied # Denies access to all files by default.
</Directory>

<Directory "/var/www/">
    AllowOverride None # Disables .htaccess files.
    Require all granted # Grants access to files in /var/www/.
</Directory>

# Default file types
<IfModule dir_module>
    DirectoryIndex index.html index.php # Specifies the default files to serve when a directory is requested.
</IfModule>

<Files ".ht*">
    Require all denied # Prevents access to .htaccess and .htpasswd files.
</Files>

# MIME types
<IfModule mime_module>
    TypesConfig /etc/mime.types # Specifies the MIME types file.
    AddType application/x-compress .Z # Adds a MIME type for compressed files.
    AddType application/x-gzip .gz .tgz # Adds MIME types for gzipped files.
    AddType text/html .shtml # Adds MIME type for server-parsed HTML files.
    AddOutputFilter INCLUDES .shtml # Enables server-side includes for .shtml files.
</IfModule>

# Logging
ErrorLog ${APACHE_LOG_DIR}/error.log # Specifies the file for error logs.
LogLevel warn # Sets the logging level for errors to 'warn' and above.
LogFormat "%h %l %u %t \"%r\" %>s %O \"%{Referer}i\" \"%{User-Agent}i\"" combined # Defines a combined log format.
LogFormat "%h %l %u %t \"%r\" %>s %O" common # Defines a common log format.
LogFormat "%{Referer}i -> %U" referer # Defines a log format for referer information.
LogFormat "%{User-agent}i" agent # Defines a log format for user agent information.

# Include additional configurations
# Includes other configuration files, typically for modules and virtual hosts.
Include /etc/apache2/mods-enabled/*.load # Loads module definitions.
Include /etc/apache2/mods-enabled/*.conf # Includes module configurations.
Include /etc/apache2/conf-enabled/*.conf # Includes general configurations.
Include /etc/apache2/sites-enabled/*.conf # Includes virtual host configurations.


